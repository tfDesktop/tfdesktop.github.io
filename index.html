<html>
    <head>
        <title>tfDesktop</title>
		<link rel="icon" href="/favicon.ico">
    </head>
    <body style="margin: 0px; height:100%; min-height:100%;" onload="embedContent()">
		<noscript>Please enable Javascript</noscript>
		<div id="container" style="display:table; height:100%; width:100%;">
			<div id="wrapper" style="display:table-cell; vertical-align:middle;">
				<div id="loading" style="width: 100%; text-align: center; position: relative; top: 50%; transform: translateY(-50%);"><h1>LOADING...</h1></div>
			</div>
		</div>
		<script>
			function getSearchParams(url){
				var params = {};
				if(url && url.search){
					var allParams = url.search.split("?")[1];
					if(allParams){
						var pairs = allParams.split("&");
						if(pairs){
							for(var i = 0; i < pairs.length; i++){
								var pair = pairs[i].split("=");
								params[pair[0]] = pair[1];
							}
						}
					}
				}
				return params;
			}
			
			function embedContent(){
				var searchParams = getSearchParams(location);
				var fileId = searchParams["id"];
				var fileName = searchParams["gds"];
				if(fileId || fileName){
					var baseUrl = "https://script.google.com/a/macros/travelfusion.com/s/AKfycbzEaukyhX5Xw0kt_e9SQuhc6qGg7loVpWG_x09tAwTvlMMT0alL0zVxEy7CK5euQSl-CA/exec?";
					var frame = document.createElement("iframe");
					frame.setAttribute("width", "100%");
					frame.setAttribute("height", "100%");
					frame.setAttribute("frameborder", "none");
					if (fileId) {
						frame.setAttribute("src", baseUrl + "id=" + fileId);
					} else {
						frame.setAttribute("src", baseUrl + "name=" + fileName);
					}
					frame.onload = function(){
						document.body.removeChild(container);
					};
					
					document.body.appendChild(frame);
				}else{
					location = "https://www.travelfusion.com/corporate/page/tf-desktop";
				}
			}
		</script>
    </body>
</html>
